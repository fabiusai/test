<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Social Mockup</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    body { font-family: Arial; background: #f5f5f5; padding: 20px; }
    button { padding: 10px 20px; font-size: 16px; margin: 10px; }
    .news-tabs button.active { font-weight: bold; }
    .social-section { display: none; margin-top: 10px; }
    .social-section.active { display: block; }
    .mockup-container { border: 1px solid #ccc; padding: 10px; margin: 10px auto; width: 300px; background: white; }
  </style>
</head>
<body>
  <h1>Social Mockup</h1>

  <div class="news-tabs">
    <button data-tab="news1" class="active" onclick="selectNews(this)">News 1</button>
    <button data-tab="news2" onclick="selectNews(this)">News 2</button>
  </div>

  <div id="news1" class="news-content active">
    <div class="social-section active" data-platform="facebook">
      <div class="mockup-container">Mockup Facebook - News 1</div>
    </div>
    <div class="social-section" data-platform="linkedin">
      <div class="mockup-container">Mockup Linkedin - News 1</div>
    </div>
    <div class="social-section" data-platform="x">
      <div class="mockup-container">Mockup X - News 1</div>
    </div>
    <div class="social-section" data-platform="instagram">
      <div class="mockup-container">Mockup Instagram - News 1</div>
    </div>
  </div>

  <div id="news2" class="news-content">
    <div class="social-section active" data-platform="facebook">
      <div class="mockup-container">Mockup Facebook - News 2</div>
    </div>
    <div class="social-section" data-platform="linkedin">
      <div class="mockup-container">Mockup Linkedin - News 2</div>
    </div>
    <div class="social-section" data-platform="x">
      <div class="mockup-container">Mockup X - News 2</div>
    </div>
    <div class="social-section" data-platform="instagram">
      <div class="mockup-container">Mockup Instagram - News 2</div>
    </div>
  </div>

  <button onclick="downloadAllAsZip()">Scarica tutti i mockup (ZIP)</button>

  <script>
    function selectNews(button) {
      document.querySelectorAll('.news-tabs button').forEach(btn => btn.classList.remove('active'));
      button.classList.add('active');

      const selectedTab = button.getAttribute('data-tab');
      document.querySelectorAll('.news-content').forEach(div => div.style.display = 'none');
      document.getElementById(selectedTab).style.display = 'block';
    }

    window.onload = () => {
      document.querySelectorAll('.news-content').forEach(div => div.style.display = 'none');
      document.getElementById('news1').style.display = 'block';
    };

    function downloadAllAsZip() {
      const zip = new JSZip();
      const activeNewsTab = document.querySelector(".news-tabs button.active");
      if (!activeNewsTab) {
        alert("Seleziona prima una News.");
        return;
      }

      const newsId = activeNewsTab.getAttribute("data-tab");
      const socialSections = document.querySelectorAll(`#${newsId} .social-section`);
      let done = 0;
      const total = socialSections.length;

      socialSections.forEach(section => {
        const container = section.querySelector(".mockup-container");
        const platform = section.getAttribute("data-platform");

        html2canvas(container).then(canvas => {
          canvas.toBlob(blob => {
            zip.file(`${newsId}_${platform}.jpg`, blob);
            done++;
            if (done === total) {
              zip.generateAsync({ type: "blob" }).then(content => {
                saveAs(content, `${newsId}_mockup.zip`);
              });
            }
          });
        });
      });
    }
  </script>
</body>
</html>

